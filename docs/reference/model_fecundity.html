<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model reproductive output with age using set functional forms — model_fecundity • mpmsim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model reproductive output with age using set functional forms — model_fecundity"><meta name="description" content="This function computes reproductive output (often referred to as fertility in
human demography and fecundity in population biology) based on the logistic,
step, von Bertalanffy, Hadwiger, and normal models. The logistic model
assumes that reproductive output increases sigmoidally with age from maturity
until a maximum is reached. The step model assumes that reproductive output
is zero before the age of maturity and then remains constant. The von
Bertalanffy model assumes that, after maturity, reproductive output increases
asymptotically with age until a maximum is reached. In this formulation, the
model is set up so that reproductive output is 0 at the 'age of maturity -
1', and increases from that point. The Hadwiger model, while originally
intended to model human fertility with a characteristic hump-shaped curve, is
applied here to model fecundity (actual offspring production). For all
models, the output ensures that reproductive output is zero before the age at
maturity."><meta property="og:description" content="This function computes reproductive output (often referred to as fertility in
human demography and fecundity in population biology) based on the logistic,
step, von Bertalanffy, Hadwiger, and normal models. The logistic model
assumes that reproductive output increases sigmoidally with age from maturity
until a maximum is reached. The step model assumes that reproductive output
is zero before the age of maturity and then remains constant. The von
Bertalanffy model assumes that, after maturity, reproductive output increases
asymptotically with age until a maximum is reached. In this formulation, the
model is set up so that reproductive output is 0 at the 'age of maturity -
1', and increases from that point. The Hadwiger model, while originally
intended to model human fertility with a characteristic hump-shaped curve, is
applied here to model fecundity (actual offspring production). For all
models, the output ensures that reproductive output is zero before the age at
maturity."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mpmsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/generating_lefkovitch_models.html">Generating Lefkovitch models</a></li>
    <li><a class="dropdown-item" href="../articles/generating_leslie_models.html">Generating Leslie models</a></li>
    <li><a class="dropdown-item" href="../articles/sampling_error_propagation.html">Sampling error and its propagation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jonesor/mpmsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model reproductive output with age using set functional forms</h1>
      <small class="dont-index">Source: <a href="https://github.com/jonesor/mpmsim/blob/HEAD/R/model_reproduction.R" class="external-link"><code>R/model_reproduction.R</code></a></small>
      <div class="d-none name"><code>model_fecundity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes reproductive output (often referred to as fertility in
human demography and fecundity in population biology) based on the logistic,
step, von Bertalanffy, Hadwiger, and normal models. The logistic model
assumes that reproductive output increases sigmoidally with age from maturity
until a maximum is reached. The step model assumes that reproductive output
is zero before the age of maturity and then remains constant. The von
Bertalanffy model assumes that, after maturity, reproductive output increases
asymptotically with age until a maximum is reached. In this formulation, the
model is set up so that reproductive output is 0 at the 'age of maturity -
1', and increases from that point. The Hadwiger model, while originally
intended to model human fertility with a characteristic hump-shaped curve, is
applied here to model fecundity (actual offspring production). For all
models, the output ensures that reproductive output is zero before the age at
maturity.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">model_fecundity</span><span class="op">(</span><span class="va">params</span>, age <span class="op">=</span> <span class="cn">NULL</span>, maturity <span class="op">=</span> <span class="fl">0</span>, model <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">model_reproduction</span><span class="op">(</span><span class="va">params</span>, age <span class="op">=</span> <span class="cn">NULL</span>, maturity <span class="op">=</span> <span class="fl">0</span>, model <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">model_fertility</span><span class="op">(</span><span class="va">params</span>, age <span class="op">=</span> <span class="cn">NULL</span>, maturity <span class="op">=</span> <span class="fl">0</span>, model <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>A numeric vector of parameters for the selected model. The
number and meaning of parameters depend on the selected model.</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>A numeric vector representing age. For use in creation of MPMs and
life tables, these should be integers.</p></dd>


<dt id="arg-maturity">maturity<a class="anchor" aria-label="anchor" href="#arg-maturity"></a></dt>
<dd><p>A non-negative numeric value indicating the age at maturity.
Whatever model is used, the reproductive output is forced to be 0 below the
age of maturity.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A character string specifying the model to use. Must be one of
"logistic", "step", "vonbertalanffy","normal" or "hadwiger".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric vector representing the computed reproductive output
values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The required parameters varies depending on the model used. The
parameters are provided as a vector and the parameters must be provided in
the order mentioned here.</p><ul><li><p>Logistic: \(f_x = A / (1 + exp(-k  (x - x_m)))\)</p></li>
<li><p>Step: \(f_x=
  \begin{cases} A, x \geq m \\ 0, x &lt;  m \end{cases}\)</p></li>
<li><p>von Bertalanffy: \(f_x = A  (1 - exp(-k  (x - x_0)))\)</p></li>
<li><p>Normal: \(f_x = A \times \exp\left(
  -\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^{2}\,\right)\)</p></li>
<li><p>Hadwiger: \(f_x = \frac{ab}{C} \left (\frac{C}{x}  \right )
   ^\frac{3}{2} \exp \left \{ -b^2  \left ( \frac{C}{x}+\frac{x}{C}-2
   \right ) \right \}\)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bertalanffy, L. von (1938) A quantitative theory of organic
growth (inquiries on growth laws. II). Human Biology 10:181–213.</p>
<p>Peristera, P. &amp; Kostaki, A. (2007) Modeling fertility in modern
populations. Demographic Research. 16. Article 6, 141-194
<a href="https://doi.org/10.4054/DemRes.2007.16.6" class="external-link">doi:10.4054/DemRes.2007.16.6</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="model_survival.html">model_mortality()</a></code> to model age-specific survival using mortality
models.</p>
<p>Other trajectories:
<code><a href="model_survival.html">model_survival</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Compute reproductive output using the step model</span></span></span>
<span class="r-in"><span><span class="fu">model_fecundity</span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, maturity <span class="op">=</span> <span class="fl">2</span>, model <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0  0 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute reproductive output using the logistic model</span></span></span>
<span class="r-in"><span><span class="fu">model_fecundity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">0.5</span>, x_m <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, maturity <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="fl">0</span>, model <span class="op">=</span> <span class="st">"logistic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.1798621 0.2931223 0.4742587 0.7585818 1.1920292 1.8242552 2.6894142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 3.7754067 5.0000000 6.2245933 7.3105858 8.1757448 8.8079708 9.2414182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 9.5257413 9.7068777 9.8201379 9.8901306 9.9330715 9.9592986 9.9752738</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute reproductive output using the von Bertalanffy model</span></span></span>
<span class="r-in"><span><span class="fu">model_fecundity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span>, maturity <span class="op">=</span> <span class="fl">2</span>, model <span class="op">=</span></span></span>
<span class="r-in"><span>    <span class="st">"vonbertalanffy"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.000000 0.000000 2.591818 4.511884 5.934303 6.988058 7.768698 8.347011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 8.775436 9.092820 9.327945 9.502129 9.631168 9.726763 9.797581 9.850044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 9.888910 9.917703 9.939033 9.954834 9.966540</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute reproductive output using the normal model</span></span></span>
<span class="r-in"><span><span class="fu">model_fecundity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, maturity <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="st">"normal"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.353353e+00 3.246525e+00 6.065307e+00 8.824969e+00 1.000000e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 8.824969e+00 6.065307e+00 3.246525e+00 1.353353e+00 4.393693e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 1.110900e-01 2.187491e-02 3.354626e-03 4.006530e-04 3.726653e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 2.699579e-06 1.522998e-07 6.691586e-09 2.289735e-10 6.101937e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] 1.266417e-13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute reproductive output using the Hadwiger model</span></span></span>
<span class="r-in"><span><span class="fu">model_fecundity</span><span class="op">(</span></span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">50</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.91</span>, b <span class="op">=</span> <span class="fl">3.85</span>, C <span class="op">=</span> <span class="fl">29.78</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  maturity <span class="op">=</span> <span class="fl">0</span>, model <span class="op">=</span> <span class="st">"hadwiger"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.000000e+00 1.722961e-178  2.632756e-83  7.775444e-52  2.900424e-36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  4.854202e-27  5.511959e-21  9.752061e-17  1.285955e-13  3.012210e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  2.109246e-09  6.146616e-08  9.291611e-07  8.485057e-06  5.218334e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  2.340447e-04  8.125653e-04  2.285572e-03  5.396092e-03  1.099593e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21]  1.977597e-02  3.196159e-02  4.710896e-02  6.409793e-02  8.132898e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26]  9.704998e-02  1.097012e-01  1.181803e-01  1.219739e-01  1.211525e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31]  1.162609e-01  1.081542e-01  9.782452e-02  8.625345e-02  7.430620e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36]  6.267207e-02  5.184481e-02  4.213231e-02  3.368422e-02  2.652753e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41]  2.060288e-02  1.579689e-02  1.196842e-02  8.967956e-03  6.650857e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46]  4.885343e-03  3.556515e-03  2.567565e-03  1.839156e-03  1.307766e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51]  9.235335e-04</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">model_reproduction</span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, maturity <span class="op">=</span> <span class="fl">2</span>, model <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0  0 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</span>
<span class="r-in"><span><span class="fu">model_fertility</span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, maturity <span class="op">=</span> <span class="fl">2</span>, model <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0  0 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Owen Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

