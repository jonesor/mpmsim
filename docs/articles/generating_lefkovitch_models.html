<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generating Lefkovitch models • mpmsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating Lefkovitch models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mpmsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/generating_lefkovitch_models.html">Generating Lefkovitch models</a></li>
    <li><a class="dropdown-item" href="../articles/generating_leslie_models.html">Generating Leslie models</a></li>
    <li><a class="dropdown-item" href="../articles/sampling_error_propagation.html">Sampling error and its propagation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jonesor/mpmsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generating Lefkovitch models</h1>
            
            <h4 data-toc-skip class="date">2025-02-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/mpmsim/blob/HEAD/vignettes/generating_lefkovitch_models.Rmd" class="external-link"><code>vignettes/generating_lefkovitch_models.Rmd</code></a></small>
      <div class="d-none name"><code>generating_lefkovitch_models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Lefkovitch matrix population models (MPMs) were introduced by Leonard
Lefkovitch in his 1965 paper, “<em>The Study of Population Growth in
Organisms Grouped by Stages</em>”, published in <em>Biometrics</em>..
This paper extended the concept of Leslie MPMs, which are structured by
age, to stage-structured populations, providing a framework that has
been widely used in ecology, evolution and conservation studies.</p>
<p>In a Lefkovitch MPM, the square matrix is used to model population
growth across discrete projection intervals, typically representing
years. Each matrix element represents either a transition probability
between different stages or the reproductive output of a stage across
the projection interval. The MPM can be divided into submatrices: one
for survival/growth (the <strong>U</strong> matrix), one for sexual
reproduction (the <strong>F</strong> matrix) and one for asexual
reproduction (the <strong>C</strong> matrix), where <strong>A</strong> =
<strong>U</strong> + <strong>F</strong> + <strong>C</strong>.
Occasionally, these reproduction matrices are lumped together as a
reproduction matrix, <strong>R</strong> (i.e. <strong>R</strong> =
<strong>F</strong> + <strong>C</strong>). Reproduction is often termed
fecundity in the population biology literature.</p>
<p>The elements of the <strong>U</strong> matrix represent survival or
growth from stage-to-stage between time steps. Therefore the column sums
of the <strong>U</strong> submatrix cannot exceed 1. The reproductive
output elements in the <strong>F</strong> and <strong>C</strong> (or
<strong>R</strong>) submatrices do not have an upper bound and indicate
the number of new individuals each stage can produce in each time
interval.</p>
<p>Zero entries in the matrices indicate that those transitions do not
occur.</p>
<p>To project population size and structure over time, the MPM is
multiplied by a vector representing the current population structure
(number of individuals in each stage). This results in a new vector that
shows the predicted population structure for the next time step. This
process can be repeated to project population dynamics over multiple
time steps.</p>
<p>Lefkovitch models are useful for studying population dynamics under
different scenarios, such as changes in survival or reproductive rates,
or different management strategies. They have broad applications in both
theoretical and applied ecology.</p>
</div>
<div class="section level2">
<h2 id="aims">Aims<a class="anchor" aria-label="anchor" href="#aims"></a>
</h2>
<p>The purpose of this vignette is to illustrate how to simulate
stage-based (Lefkovitch) MPMs based on defined life history archetypes.
There are several reasons why one would want to do this, including, but
not limited to:</p>
<ul>
<li>Exploring how life history or life cycle structure influences
population dynamics.</li>
<li>Generating MPMs with defined life cycle properties for teaching
purposes.</li>
</ul>
<p>In the following sections, this vignette will:</p>
<ol style="list-style-type: decimal">
<li>Explain how life cycles can be categorised into Archetypes.</li>
<li>Show how to generate a random Lefkovitch MPM based on an
archetype.</li>
<li>Show how to rapidly produce sets of many random MPMs.</li>
<li>Show how to constrain the MPMs by matrix properties.</li>
</ol>
</div>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>Before beginning, users will need to load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/mpmsim" class="external-link">mpmsim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rage" class="external-link">Rage</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre" class="external-link">Rcompadre</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="life-cycle-archetypes-and-generating-an-mpm">1. Life cycle archetypes and generating an MPM<a class="anchor" aria-label="anchor" href="#life-cycle-archetypes-and-generating-an-mpm"></a>
</h2>
<p>In stage-based (Lefkovitch) matrix population models (MPMs),
different life cycle types can be represented by various structural
forms of the matrices. These life cycle types can be captured using
different life history archetypes, which define the transitions between
stages and the survival probabilities in the population.</p>
<p>The life history archetypes, based on Takada et al. (2018), are as
follows:</p>
<ul>
<li>Archetype 1: All elements are positive, meaning transitions from/to
any stage are possible. This model represents a life history where
individuals can progress and retrogress rapidly.</li>
<li>Archetype 2: Similar to Archetype 1, but with the survival
probability increasing monotonically as individuals advance to later
stages. This model also allows for rapid progression and retrogression
but with more realistic stage-specific survival probabilities.</li>
<li>Archetype 3: Positive non-zero elements for survival are only
allowed on the diagonal and lower sub-diagonal of the matrix. This model
represents a life cycle where retrogression is not allowed, and
progression can only happen to the immediately larger/more developed
stage (slow progression, e.g., trees).</li>
<li>Archetype 4: Similar to Archetype 3 but with the additional
assumption that stage-specific survival increases as individuals
increase in size/developmental stage.</li>
</ul>
<p>In all these archetypes, fecundity is placed in the top row of the
matrix. In Takada et al.’s paper, fecundity was always placed in the top
right of the MPM, meaning that only the “last” stage of the life cycle
reproduced. This approach can be relaxed to allow reproduction from any
stage.</p>
</div>
<div class="section level2">
<h2 id="generate-a-random-lefkovitch-mpm-based-on-an-archetype">2. Generate a random Lefkovitch MPM based on an archetype<a class="anchor" aria-label="anchor" href="#generate-a-random-lefkovitch-mpm-based-on-an-archetype"></a>
</h2>
<p>In <code>mpmsim</code> the function <code>rand_lefko_mpm</code> can
be used to generate a random MPM that conforms to one of the above four
life cycle archetypes. The function allows for the generation of random
MPMs based on these archetypes, with survival and growth (the
<strong>U</strong> matrix) based on draws from a Dirichlet distribution
to ensure biological plausibility. The Dirichlet distribution is used to
draw survival and growth values because it ensures that the sum of the
probabilities for each stage is equal to 1, which is necessary for
biologically realistic models. The function allows users to specify a
wide range of reproductive output scenarios , offering flexibility in
how fecundity is modelled across stages.</p>
<p>The function is straightforward. In the following example, I create a
three-stage MPM based on Archetype 2. I set fecundity, arbitrarily, to
be 5. By default, if only a single value is given, this is placed in the
top-right hand corner of the <strong>F</strong> matrix. Also, by
default, all fecundity is assumed to be sexual.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rand_lefko_mpm.html">rand_lefko_mpm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fl">5</span>, archetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mat_A</span></span>
<span><span class="co">#&gt;             [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.005877166 0.10766181 5.72412770</span></span>
<span><span class="co">#&gt; [2,] 0.509913175 0.03602856 0.06736799</span></span>
<span><span class="co">#&gt; [3,] 0.287840153 0.74138349 0.19955576</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mat_U</span></span>
<span><span class="co">#&gt;             [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.005877166 0.10766181 0.72412770</span></span>
<span><span class="co">#&gt; [2,] 0.509913175 0.03602856 0.06736799</span></span>
<span><span class="co">#&gt; [3,] 0.287840153 0.74138349 0.19955576</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mat_F</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    0    0    5</span></span>
<span><span class="co">#&gt; [2,]    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0</span></span></code></pre></div>
<p>To introduce variability in fecundity, users can provide reproductive
output as a list of two matrices, with numeric values of the same
dimensions as <code>n_stages</code>, representing the lower and upper
limits of mean fecundity for the entire matrix model. Reproductive
output values are then drawn from a uniform distribution between the two
values. Users should use 0 for both lower and upper limits in cases with
no fecundity.</p>
<p>The following code provides an example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lower_reprod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">upper_reprod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">20</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rand_lefko_mpm.html">rand_lefko_mpm</a></span><span class="op">(</span></span>
<span>  n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">lower_reprod</span>, <span class="va">upper_reprod</span><span class="op">)</span>,</span>
<span>  archetype <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $mat_A</span></span>
<span><span class="co">#&gt;           [,1]      [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.0873477 2.6402006 15.2043937</span></span>
<span><span class="co">#&gt; [2,] 0.4082913 0.1851252  0.5516964</span></span>
<span><span class="co">#&gt; [3,] 0.3924441 0.1736190  0.1107596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mat_U</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.0873477 0.5799473 0.3249008</span></span>
<span><span class="co">#&gt; [2,] 0.4082913 0.1851252 0.5516964</span></span>
<span><span class="co">#&gt; [3,] 0.3924441 0.1736190 0.1107596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mat_F</span></span>
<span><span class="co">#&gt;      [,1]     [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,]    0 2.060253 14.87949</span></span>
<span><span class="co">#&gt; [2,]    0 0.000000  0.00000</span></span>
<span><span class="co">#&gt; [3,]    0 0.000000  0.00000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generate-sets-of-lefkovitch-matrices">3. Generate sets of Lefkovitch matrices<a class="anchor" aria-label="anchor" href="#generate-sets-of-lefkovitch-matrices"></a>
</h2>
<p>It is sometimes desirable to create large numbers of MPMs with
particular properties in order to test hypotheses. For stage-based
(Lefkovitch) MPMs, this can be implemented using the
<code>rand_lefko_set</code> function. This function acts as a wrapper
for the previously described function and generates a set of Lefkovitch
MPMs based on a defined life cycle archetype and specified reproductive
output. For example, users may wish to generate MPMs for different life
history archetypes to explore how life cycle structure may influence
population dynamics. By specifying the number of stages, fecundity
values, and archetypes, users can produce MPMs that are tailored to
their specific research needs. This capability is useful for exploring
the effects of life history traits on population dynamics, testing
ecological and evolutionary hypotheses, and for teaching purposes.</p>
<p>The function returns either a <code>list</code> or a
<code>CompadreDB</code> object depending on the <code>output</code>
argument. If the output is set as a <code>CompadreDB</code> object, the
archetype of the MPM is included as a column of metadata.</p>
<p>The following code shows how users can generate 100 matrices in a
<code>CompadreDB</code> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myMatrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rand_lefko_set.html">rand_lefko_set</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100</span>, n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  archetype <span class="op">=</span> <span class="fl">4</span>, output <span class="op">=</span> <span class="st">"Type1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>After producing the output as a <code>CompadreDB</code> object, the
matrices can be accessed using functions from the <code>RCompadre</code>
R package. For example, to get the <strong>A</strong> matrix, or the
<strong>U</strong>/<strong>F</strong> submatrices users can use the
<code>matA</code>, <code>matU</code> or <code>matF</code> functions. The
following code illustrates how to rapidly calculate population growth
rate for all of the matrices.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain the matrices</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/CompadreMatrixMethods.html" class="external-link">matA</a></span><span class="op">(</span><span class="va">myMatrices</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate lambda for each matrix</span></span>
<span><span class="va">lambdaVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">popdemo</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html" class="external-link">eigs</a></span>, what <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lambdaVals</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.7378  1.1395  1.4965  1.4653  1.7106  2.1926</span></span></code></pre></div>
<p>Users can examine the vignettes for the <code>Rcompadre</code> and
<code>Rage</code> packages for additional insight into other potential
operations with the <code>compadreDB</code> object.</p>
</div>
<div class="section level2">
<h2 id="constraining-the-output-matrices">4. Constraining the output matrices<a class="anchor" aria-label="anchor" href="#constraining-the-output-matrices"></a>
</h2>
<p>Critically, users can impose constraints on the “acceptable”
properties of these randomly generated MPMs. For example, in some
analyses, it may be desirable to generate MPMs where the population
growth rate is constrained to values near 1.</p>
<p>This is handled by the <code>constraint</code> argument, which takes
a data frame specifying the criteria for acceptable MPMs. The data frame
must have four columns: <code>fun</code>, <code>arg</code>,
<code>lower</code>, and <code>upper</code>. The <code>fun</code> column
contains the name of the function that calculates the metric to be
constrained (e.g., <code>eigs</code>, from the <code>popdemo</code>
package). The <code>arg</code> column specifies any additional argument
that the function requires (e.g., <code>what = "lambda"</code> for the
<code>eigs</code> function), using <code>NA</code> if no additional
argument is needed. The <code>lower</code> and <code>upper</code>
columns set the bounds of the acceptable range for the metric.</p>
<p>Here’s an example of how to use the constraint argument to ensure
that the generated MPMs have a population growth rate (lambda) between
0.9 and 1.1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">popdemo</span><span class="op">)</span></span>
<span></span>
<span><span class="va">constrain_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="st">"eigs"</span>, arg <span class="op">=</span> <span class="st">"lambda"</span>, lower <span class="op">=</span> <span class="fl">0.9</span>, upper <span class="op">=</span> <span class="fl">1.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">myMatrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rand_lefko_set.html">rand_lefko_set</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100</span>, n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fl">12</span>, constraint <span class="op">=</span> <span class="va">constrain_df</span>,</span>
<span>  archetype <span class="op">=</span> <span class="fl">4</span>, output <span class="op">=</span> <span class="st">"Type1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can check that it has worked by examining the matrices.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain the matrices</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/CompadreMatrixMethods.html" class="external-link">matA</a></span><span class="op">(</span><span class="va">myMatrices</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate lambda for each matrix</span></span>
<span><span class="va">lambdaVals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">popdemo</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html" class="external-link">eigs</a></span>, what <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lambdaVals</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.9019  0.9612  1.0148  1.0115  1.0635  1.0984</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette has provided a comprehensive guide to generating
Lefkovitch matrix population models (MPMs) based on life history
archetypes. By using the <code>rand_lefko_mpm</code> and
<code>rand_lefko_set</code> functions, users can create individual MPMs
or large sets of MPMs tailored to specific research needs. The ability
to impose constraints on these models allows for precise control over
their properties, ensuring that generated MPMs meet defined criteria,
such as specific population growth rates.</p>
<p>The flexibility and power of these functions facilitate the
exploration of population dynamics under various scenarios, aiding in
hypothesis testing in studies of population biology and life history
theory. Additionally, tight integration with the <code>RCompadre</code>
package facilitates the use of generated models, enhancing their utility
in both theoretical and applied ecological research.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Owen Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
