<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mpmsim">
<title>Exploring PCA space • mpmsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploring PCA space">
<meta property="og:description" content="mpmsim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mpmsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/age_from_stage.html">The robustness of age from stage methods</a>
    <a class="dropdown-item" href="../articles/error_propagation.html">Sampling error and its propagation</a>
    <a class="dropdown-item" href="../articles/pca.html">Exploring PCA space</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jonesor/mpmsim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Exploring PCA space</h1>
                        <h4 data-toc-skip class="author">Owen Jones</h4>
            
            <h4 data-toc-skip class="date">2023-06-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jonesor/mpmsim/blob/HEAD/vignettes/pca.Rmd" class="external-link"><code>vignettes/pca.Rmd</code></a></small>
      <div class="d-none name"><code>pca.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Several interesting analyses have used MPMs from many species to
explore life history strategies using principal components analysis
(PCA). A potential criticism of these studies is that the underlying
data are biased towards certain taxa, life histories, and biomes. It is
unclear how much this bias could influence observed patterns. It would
therefore be useful to simulate realistic MPMs to explore the potential
artefactual patterns that could emerge from biased data. Here I show how
<code>mpmsim</code> can help with this task and enable the exploration
of PCA space as an aid to understanding life history strategies.</p>
</div>
<div class="section level2">
<h2 id="simulating-data-for-a-pca">Simulating data for a PCA<a class="anchor" aria-label="anchor" href="#simulating-data-for-a-pca"></a>
</h2>
<p>Load the required packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/mpmsim" class="external-link">mpmsim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rage" class="external-link">Rage</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/Rcompadre" class="external-link">Rcompadre</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">popbio</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify" class="external-link">ggfortify</a></span><span class="op">)</span></span></code></pre></div>
<p>First use <code><a href="../reference/generate_mpm_set.html">generate_mpm_set()</a></code> to simulate 50 matrices
with the archetype 1 life history from Takada et al. (2018). This life
history archetype is one where transition from/to any stage is possible
and where individuals can progress and retrogress rapidly. After
simulating the matrices they can be placed into a
<code>CompadreDB</code> object using <code><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_build_cdb.html" class="external-link">cdb_build_cdb()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">constrain_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"lambda"</span>, arg <span class="op">=</span> <span class="cn">NA</span>, lower <span class="op">=</span> <span class="fl">0.9</span>, upper <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="va">mpm_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_mpm_set.html">generate_mpm_set</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">50</span>, n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>, archetype <span class="op">=</span> <span class="fl">1</span>, split <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_surv <span class="op">=</span> <span class="fl">0.95</span>, constraint <span class="op">=</span> <span class="va">constrain_df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_life_hist_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_build_cdb.html" class="external-link">cdb_build_cdb</a></span><span class="op">(</span>mat_u <span class="op">=</span> <span class="va">mpm_set</span><span class="op">$</span><span class="va">U_list</span>, mat_f <span class="op">=</span> <span class="va">mpm_set</span><span class="op">$</span><span class="va">F_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in cdb_build_cdb(mat_u = mpm_set$U_list, mat_f = mpm_set$F_list): Metadata does not include a `SpeciesAccepted` column, so number</span></span>
<span><span class="co">#&gt;               of species not provided when viewing object.</span></span></code></pre></div>
<p>Some of these matrices will be reducible, which leads to analytical
problems with some calculations. These can be filtered out using
<code><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_flag.html" class="external-link">cdb_flag()</a></code> followed by <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_life_hist_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_flag.html" class="external-link">cdb_flag</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span>, checks <span class="op">=</span> <span class="st">"check_irreducible"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">check_irreducible</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>For convenience, these matrices can be added to the
<code>compadreDB</code> object like this, and turned into a regular data
frame (<code>tibble</code>) like this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put the matrices into the metadata</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/CompadreMatrixMethods.html" class="external-link">matA</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/CompadreMatrixMethods.html" class="external-link">matU</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/CompadreMatrixMethods.html" class="external-link">matF</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use cdb_metadata to turn this into a data frame</span></span>
<span><span class="va">sim_life_hist_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/cdb_metadata.html" class="external-link">cdb_metadata</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">)</span></span></code></pre></div>
<p>Before proceeding with the calculation of life history traits I make
a new function, <code>gt_lt</code>, to calculate generation time from a
life table.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New functions to calculate generation time from life table.</span></span>
<span><span class="co"># Function to calculate generation time from the life table</span></span>
<span><span class="va">gt_lt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">matU</span>, <span class="va">matF</span>, <span class="va">start</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tempLT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rage/man/mpm_to_table.html" class="external-link">mpm_to_table</a></span><span class="op">(</span><span class="va">matU</span>, <span class="va">matF</span>, start <span class="op">=</span> <span class="va">start</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tempLT</span><span class="op">$</span><span class="va">x</span> <span class="op">*</span> <span class="va">tempLT</span><span class="op">$</span><span class="va">lxmx</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tempLT</span><span class="op">$</span><span class="va">lxmx</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now we can use a combination of <code>sapply</code> and
<code>mapply</code> to calculate the life history traits for each matrix
model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">gt_lt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">gt_lt</span>, <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span>,</span>
<span>                                <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matF</span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">longevity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span>,</span>
<span>                                    <span class="fu">Rage</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Rage/man/longevity.html" class="external-link">longevity</a></span>,</span>
<span>                                    x_max <span class="op">=</span> <span class="fl">1000</span>, lx_crit <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">lifeExpect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span>,</span>
<span>                                     <span class="fu">Rage</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Rage/man/life_expect.html" class="external-link">life_expect_mean</a></span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">entropy_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">entropy_d</span>,</span>
<span>                                    <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span>,</span>
<span>                                    <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matF</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">entropy_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">entropy_k</span>, <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span><span class="op">)</span></span>
<span><span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">nrr_R0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span>  <span class="va">net_repro_rate</span>, <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matU</span>,</span>
<span>  <span class="va">sim_life_hist_1</span><span class="op">$</span><span class="va">matF</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we have added these variables to the data set we can extract them
into a dataset for the PCA.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pcData</span> <span class="op">&lt;-</span> <span class="va">sim_life_hist_1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gt_lt</span>, <span class="va">longevity</span>, <span class="va">lifeExpect</span>, <span class="va">entropy_d</span>, <span class="va">entropy_k</span>, <span class="va">nrr_R0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Then we can run the PCA, and add the first two principle components
to the data frame for plotting purposes.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">pcData</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, center <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add the PC data to the raw data.</span></span>
<span><span class="va">pcData</span> <span class="op">&lt;-</span> <span class="va">pcData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">PCA</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The plot can be made using <code>autoplot</code>, from the
<code>ggfortify</code> package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCA_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">PCA</span>, alpha <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">4</span>, fill <span class="op">=</span> <span class="st">"#55616D60"</span>,</span>
<span>  loadings.colour <span class="op">=</span> <span class="st">"#0072B2"</span>, shape <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  loadings <span class="op">=</span> <span class="cn">TRUE</span>, loadings.label <span class="op">=</span> <span class="cn">TRUE</span>, loadings.label.colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  loadings.label.size <span class="op">=</span> <span class="fl">3</span>, loadings.label.repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  frame <span class="op">=</span> <span class="cn">FALSE</span>, frame.type <span class="op">=</span> <span class="st">"norm"</span>, scale <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">PCA_plot</span><span class="op">$</span><span class="va">layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">pcData</span><span class="op">$</span><span class="va">PC1</span>,</span>
<span>      y <span class="op">=</span> <span class="va">pcData</span><span class="op">$</span><span class="va">PC2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="va">PCA_plot</span><span class="op">$</span><span class="va">layers</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">PCA_plot</span></span></code></pre></div>
<p><img src="pca_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The PCA loadings show two strong axes. One with evolutionary entropy,
longevity, generation time and life expectancy aligned, and one with R0
on its own. Life table entropy is aligned more or less equally with
both. This is a rather different pattern than can be observed with real
data. Why?</p>
</div>
<div class="section level2">
<h2 id="repeating-with-a-different-archetype">Repeating with a different archetype<a class="anchor" aria-label="anchor" href="#repeating-with-a-different-archetype"></a>
</h2>
<p>If we repeat the whole analysis with a different archetype (4) we get
the following plot.</p>
<p><img src="pca_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Owen Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
