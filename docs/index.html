<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Allows users to generate matrix population models (MPMs) with
    particular characteristics based on aspects of life history such as
    mortality trajectories and fertility trajectories.">
<title>Simulates Matrix Population Models with Particular Life History
    Characteristics • mpmsim</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulates Matrix Population Models with Particular Life History
    Characteristics">
<meta property="og:description" content="Allows users to generate matrix population models (MPMs) with
    particular characteristics based on aspects of life history such as
    mortality trajectories and fertility trajectories.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">mpmsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jonesor/mpmsim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mpmsim">mpmsim<a class="anchor" aria-label="anchor" href="#mpmsim"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p><code>mpmsim</code> contains tools for generating random or semi-random matrix population models (MPMs) given a particular life history archetype. It also facilitates the generation of Leslie matrices, and the simulation of MPMs based on expected transition rates and sample sizes. This can be useful for exploring uncertainty in inferences when sample sizes are small (or unknown).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>mpmsim</code> like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install package 'remotes' if necessary</span>
<span class="co"># will already be installed if 'devtools' is installed</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>

<span class="co"># argument 'build_opts = NULL' only needed if you want to build vignettes</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jonesor/mpmsim"</span>, build_opts <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>First remember to load the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonesor/mpmsim" class="external-link">mpmsim</a></span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="generate-single-random-mpms">Generate single random MPMs<a class="anchor" aria-label="anchor" href="#generate-single-random-mpms"></a>
</h3>
<p>The <code>random_mpm</code> function can be used to generate a random matrix population model (MPM) with element values based on defined life history archetypes. The function draws survival and transition/growth probabilities from a Dirichlet distribution to ensure that the column totals, including death, are less than or equal to 1. Fecundity can be specified as a single value or as a vector with a length equal to the dimensions of the matrix. If specified as a single value, it is placed in the top-right corner of the matrix. If specified as a vector of length <code>n_stages</code>, it spans the entire top row of the matrix. The <code>archetype</code> argument can be used to constrain the MPMs, for example, <code>archetype = 2</code> constraints the survival probability to increase monotonically as individuals advance to later stages. For more information, see the documentation for <code>random_mpm</code> and Takada et al. (2018).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/random_mpm.html">random_mpm</a></span><span class="op">(</span>n_stages <span class="op">=</span> <span class="fl">3</span>, fecundity <span class="op">=</span> <span class="fl">20</span>, archetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;            [,1]        [,2]        [,3]</span>
<span class="co">#&gt; [1,] 0.14593481 0.007827801 18.11573135</span>
<span class="co">#&gt; [2,] 0.26071218 0.287536334  0.09134083</span>
<span class="co">#&gt; [3,] 0.09852245 0.338007399  0.78820450</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-a-set-of-random-mpms">Generate a set of random MPMs<a class="anchor" aria-label="anchor" href="#generate-a-set-of-random-mpms"></a>
</h3>
<p>The <code>generate_mpm_set</code> function can be used to quickly generate large numbers of MPMs using the above approach. For example, the following code generates five MPMs with archetype 1. By using the <code>lower_lambda</code> and <code>upper_lambda</code> arguments, users can specify an acceptable population growth rate range for the set of matrices. This can be useful for life history analyses where we might assume that only life histories with lambda values close to 1 can persist in nature.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/generate_mpm_set.html">generate_mpm_set</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">5</span>, n_stages <span class="op">=</span> <span class="fl">4</span>, fecundity <span class="op">=</span> <span class="fl">8</span>, archetype <span class="op">=</span> <span class="fl">1</span>,
  lower_lambda <span class="op">=</span> <span class="fl">0.9</span>, upper_lambda <span class="op">=</span> <span class="fl">1.1</span>
<span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;             [,1]       [,2]      [,3]       [,4]</span>
<span class="co">#&gt; [1,] 0.064408732 0.19225511 0.1630526 5.05030022</span>
<span class="co">#&gt; [2,] 0.362072964 0.10325923 0.2245503 0.11250344</span>
<span class="co">#&gt; [3,] 0.008312629 0.33342500 0.2932137 0.02378394</span>
<span class="co">#&gt; [4,] 0.032424958 0.06810737 0.2972872 0.32113716</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;             [,1]       [,2]       [,3]       [,4]</span>
<span class="co">#&gt; [1,] 0.819935311 0.33252212 0.01560667 2.00828838</span>
<span class="co">#&gt; [2,] 0.076067966 0.15186750 0.52037328 0.08833381</span>
<span class="co">#&gt; [3,] 0.030469115 0.13730222 0.14996826 0.29747834</span>
<span class="co">#&gt; [4,] 0.006764007 0.09055314 0.06526593 0.57119447</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;            [,1]       [,2]        [,3]      [,4]</span>
<span class="co">#&gt; [1,] 0.36404945 0.30897256 0.292034462 2.0407118</span>
<span class="co">#&gt; [2,] 0.04920986 0.49314064 0.004769913 0.3070033</span>
<span class="co">#&gt; [3,] 0.40605086 0.09240266 0.092382356 0.3084696</span>
<span class="co">#&gt; [4,] 0.11178377 0.03479140 0.067128935 0.0614791</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span>
<span class="co">#&gt; [1,] 0.02760317 0.21540974 0.08144286 1.02504746</span>
<span class="co">#&gt; [2,] 0.23027843 0.05060720 0.13743130 0.54661451</span>
<span class="co">#&gt; [3,] 0.51124413 0.09249182 0.08792638 0.29240540</span>
<span class="co">#&gt; [4,] 0.21719111 0.11598901 0.30070810 0.06425316</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;            [,1]       [,2]        [,3]       [,4]</span>
<span class="co">#&gt; [1,] 0.18894171 0.11260624 0.024629726 5.07550296</span>
<span class="co">#&gt; [2,] 0.36168035 0.58972901 0.001749499 0.31297409</span>
<span class="co">#&gt; [3,] 0.04935836 0.03890263 0.555065578 0.21863629</span>
<span class="co">#&gt; [4,] 0.02334261 0.02593192 0.326267519 0.01731732</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-a-leslie-matrix">Generate a Leslie matrix<a class="anchor" aria-label="anchor" href="#generate-a-leslie-matrix"></a>
</h3>
<p>The <code>make_leslie_matrix</code> function can be used to generate a Leslie matrix, where the stages represent discrete age classes. In a Leslie matrix, survival is represented in the lower sub-diagonal and the lower-right-hand corner element, while fertility is shown in the top row. Both survival and fertility have a length equal to the number of stages in the model. Users can specify both survival and fertility as either a single value or a vector of values, with a length equal to the dimensions of the matrix model. If these arguments are single values, the value is repeated along the survival/fertility sequence.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/make_leslie_matrix.html">make_leslie_matrix</a></span><span class="op">(</span>
  survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.45</span>, length.out <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
  fertility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2.4</span>, <span class="fl">5</span><span class="op">)</span>, n_stages <span class="op">=</span> <span class="fl">4</span>, split <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt;      [,1]      [,2]      [,3] [,4]</span>
<span class="co">#&gt; [1,]  0.0 0.0000000 2.4000000 5.00</span>
<span class="co">#&gt; [2,]  0.1 0.0000000 0.0000000 0.00</span>
<span class="co">#&gt; [3,]  0.0 0.2166667 0.0000000 0.00</span>
<span class="co">#&gt; [4,]  0.0 0.0000000 0.3333333 0.45</span></code></pre></div>
<p>Users can generate large numbers of plausible Leslie matrices by repeating the <code>make_leslie_matrix</code> command in a loop. For example, the following code produces a list of 10 Leslie matrices that have increasing survival with age.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">juvSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0.0</span>, max <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">adultSurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, min <span class="op">=</span> <span class="fl">0.4</span>, max <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="va">adultFert</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span>

<span class="va">outputMPMs</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">outputMPMs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_leslie_matrix.html">make_leslie_matrix</a></span><span class="op">(</span>
    survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">juvSurv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">adultSurv</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,
    fertility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">adultFert</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, n_stages <span class="op">=</span> <span class="fl">6</span>, split <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">outputMPMs</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 5.0000000 5.0000000 5.0000000 5.0000000</span>
<span class="co">#&gt; [2,] 0.08329273 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1914417 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2995907 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.4077397 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.5158888 0.6240378</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 5.0000000 5.0000000 5.0000000 5.0000000</span>
<span class="co">#&gt; [2,] 0.01647593 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1452402 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2740045 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.4027688 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.5315331 0.6602974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;            [,1]      [,2]     [,3]     [,4]     [,5]     [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 6.000000 6.000000 6.000000 6.000000</span>
<span class="co">#&gt; [2,] 0.08245093 0.0000000 0.000000 0.000000 0.000000 0.000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1521489 0.000000 0.000000 0.000000 0.000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.221847 0.000000 0.000000 0.000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.000000 0.291545 0.000000 0.000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.000000 0.000000 0.361243 0.430941</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]     [,5]     [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 4.0000000 4.0000000 4.000000 4.000000</span>
<span class="co">#&gt; [2,] 0.08905316 0.0000000 0.0000000 0.0000000 0.000000 0.000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1772351 0.0000000 0.0000000 0.000000 0.000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2654171 0.0000000 0.000000 0.000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.3535991 0.000000 0.000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.441781 0.529963</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;            [,1]     [,2]       [,3]       [,4]       [,5]       [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.000000 15.0000000 15.0000000 15.0000000 15.0000000</span>
<span class="co">#&gt; [2,] 0.03790716 0.000000  0.0000000  0.0000000  0.0000000  0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.156967  0.0000000  0.0000000  0.0000000  0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.000000  0.2760268  0.0000000  0.0000000  0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.000000  0.0000000  0.3950866  0.0000000  0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.000000  0.0000000  0.0000000  0.5141464  0.6332061</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 6.0000000 6.0000000 6.0000000 6.0000000</span>
<span class="co">#&gt; [2,] 0.09731798 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1906858 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2840536 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.3774215 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.4707893 0.5641571</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[7]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 9.0000000 9.0000000 9.0000000 9.0000000</span>
<span class="co">#&gt; [2,] 0.07364893 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1571379 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2406268 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.3241157 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.4076047 0.4910936</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[8]]</span>
<span class="co">#&gt;            [,1]      [,2]     [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 7.000000 7.0000000 7.0000000 7.0000000</span>
<span class="co">#&gt; [2,] 0.07149147 0.0000000 0.000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.2001247 0.000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.328758 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.000000 0.4573913 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.000000 0.0000000 0.5860246 0.7146578</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[9]]</span>
<span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.00000000 0.0000000 4.0000000 4.0000000 4.0000000 4.0000000</span>
<span class="co">#&gt; [2,] 0.03279912 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.00000000 0.1172902 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.00000000 0.0000000 0.2017813 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.00000000 0.0000000 0.0000000 0.2862724 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.00000000 0.0000000 0.0000000 0.0000000 0.3707634 0.4552545</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[10]]</span>
<span class="co">#&gt;             [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span>
<span class="co">#&gt; [1,] 0.000000000 0.0000000 7.0000000 7.0000000 7.0000000 7.0000000</span>
<span class="co">#&gt; [2,] 0.008235867 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.000000000 0.1564386 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [4,] 0.000000000 0.0000000 0.3046413 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; [5,] 0.000000000 0.0000000 0.0000000 0.4528441 0.0000000 0.0000000</span>
<span class="co">#&gt; [6,] 0.000000000 0.0000000 0.0000000 0.0000000 0.6010468 0.7492495</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-an-mpm-using-a-particular-sample-size">Simulate an MPM using a particular sample size<a class="anchor" aria-label="anchor" href="#simulate-an-mpm-using-a-particular-sample-size"></a>
</h3>
<p>The function <code>simulate_mpm</code> can be used to simulate an MPM based on expected transition rates (survival and fecundity) and sample sizes. The expected transition rates must be provided as matrices. The sample size(s) can be given as either a matrix of sample sizes for each element of the matrix or as a single value which is then applied to all elements of the matrix.</p>
<p>The function uses a binomial process to simulate survival/growth elements and a Poisson process to simulate the fecundity elements. As a result, when sample sizes are large, the simulated MPM will closely reflect the expected transition rates. In contrast, when sample sizes are small, the simulated matrices will become more variable.</p>
<p>To illustrate use of the function, the following code first generates a 3-stage Leslie matrix using the <code>make_leslie_matrix</code> function. It then passes the U and F matrices from this Leslie matrix to the <code>simulate_mpm</code> function. Then, two matrices are simulated, first with a sample size of 1000, and then with a sample size of seven.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mats</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/make_leslie_matrix.html">make_leslie_matrix</a></span><span class="op">(</span>
  survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>,
  fertility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.2</span>, <span class="fl">4.4</span><span class="op">)</span>,
  n_stages <span class="op">=</span> <span class="fl">3</span>, split <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu"><a href="reference/simulate_mpm.html">simulate_mpm</a></span><span class="op">(</span>
  matU <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matU</span>, matF <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matF</span>,
  sample_size <span class="op">=</span> <span class="fl">1000</span>, split <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt;      [,1]  [,2] [,3]</span>
<span class="co">#&gt; [1,] 0.00 2.227 4.31</span>
<span class="co">#&gt; [2,] 0.29 0.000 0.00</span>
<span class="co">#&gt; [3,] 0.00 0.504 0.79</span>

<span class="fu"><a href="reference/simulate_mpm.html">simulate_mpm</a></span><span class="op">(</span>
  matU <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matU</span>, matF <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matF</span>,
  sample_size <span class="op">=</span> <span class="fl">7</span>, split <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 1.5714286 3.8571429</span>
<span class="co">#&gt; [2,] 0.2857143 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.2857143 0.7142857</span></code></pre></div>
<p>A list of an arbitrary number of matrices can be generated easily using <code>replicate</code>, as follows.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fl">5</span>,
  <span class="fu"><a href="reference/simulate_mpm.html">simulate_mpm</a></span><span class="op">(</span>
    matU <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matU</span>, matF <span class="op">=</span> <span class="va">mats</span><span class="op">$</span><span class="va">matF</span>,
    sample_size <span class="op">=</span> <span class="fl">7</span>, split <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; , , 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 1.8571429 4.4285714</span>
<span class="co">#&gt; [2,] 0.1428571 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.4285714 0.8571429</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 2.0000000 3.7142857</span>
<span class="co">#&gt; [2,] 0.1428571 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.7142857 0.8571429</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 1.7142857 4.7142857</span>
<span class="co">#&gt; [2,] 0.4285714 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.4285714 0.5714286</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 2.2857143 5.7142857</span>
<span class="co">#&gt; [2,] 0.2857143 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.2857143 0.8571429</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           [,1]      [,2]      [,3]</span>
<span class="co">#&gt; [1,] 0.0000000 1.5714286 3.8571429</span>
<span class="co">#&gt; [2,] 0.1428571 0.0000000 0.0000000</span>
<span class="co">#&gt; [3,] 0.0000000 0.4285714 0.7142857</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>All contributions are welcome. Please note that this project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
<p>There are numerous ways of contributing.</p>
<ol style="list-style-type: decimal">
<li><p>You can submit bug reports, suggestions etc. by <a href="https://github.com/jonesor/mpmsim/issues" class="external-link">opening an issue</a>.</p></li>
<li><p>You can copy or fork the repository, make your own code edits and then send us a pull request. <a href="https://jarv.is/notes/how-to-pull-request-fork-github/" class="external-link">Here’s how to do that</a>.</p></li>
<li><p>You are also welcome to email me.</p></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/jonesor/mpmsim/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/jonesor/mpmsim/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://creativecommons.org/licenses/by-sa/4.0" class="external-link">CC BY-SA 4.0</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mpmsim</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Owen Jones <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5720-4686" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Owen Jones.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
