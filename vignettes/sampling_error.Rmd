---
title: "Exploring sampling error"
author: "Owen Jones"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignette we will explore sampling error which is associated with small sample sizes.

Let's say we have estimated a Matrix model that looks like this.


```{r}
matU <- matrix(c(0.1, 0,
              0.2, 0.4), byrow = TRUE, nrow = 2)

matF <- matrix(c(0, 3,
              0, 0), byrow = TRUE, nrow = 2)

matA <- matU + matF
```


The estimated population growth rate is this:

```{r}
popdemo::eigs(matA,"lambda")
```

But this data come from a sample collected in the real world. It is therefore likely that there is some errors introduced by sampling error.
Let's simulate the matrix values estimated and with a small sample size of 10.

```{r}
simMat_1 <- mpmsim::simulate_mpm(mat_U = matU, mat_F = matF,sample_size = 10,split = FALSE)
```

```{r}
popdemo::eigs(simMat_1,"lambda")
```

If you don't have a standard error estimate but know that your data comes from a binomial process, you can calculate the standard error using the formula:

SE = sqrt(p * (1 - p) / n)

where p is the probability of success (or the proportion of successes) and n is the sample size.

For example, if you have a sample of 100 observations and 60 of them are successes, the estimated probability of success is 0.6. The standard error would be:

SE = sqrt(0.6 * (1 - 0.6) / 100) = 0.04899

This means that you can be 95% confident that the true proportion of successes in the population falls within the range of:

For the U matrix then,

```{r}

```

