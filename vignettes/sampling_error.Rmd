---
title: "Exploring sampling error"
author: "Owen Jones"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Exploring sampling error}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignette we will explore sampling error which is associated with small sample sizes.

Let's say we have estimated a Matrix model that looks like this.


```{r}
matU <- matrix(c(0.1, 0.0,
                 0.2, 0.4), byrow = TRUE, nrow = 2)

matF <- matrix(c(0.0, 3.0,
                 0.0, 0.0), byrow = TRUE, nrow = 2)

matA <- matU + matF
```


The estimated population growth rate is this:

```{r}
popdemo::eigs(matA,"lambda")
```

But this data come from a sample collected in the real world. It is therefore likely that there is some errors introduced by sampling error.
Let's simulate the matrix values estimated and with a small sample size of 10.

```{r}
simMat_1 <- mpmsim::simulate_mpm(mat_U = matU, mat_F = matF,sample_size = 10,split = FALSE)
```


We can repeat this many times:

```{r}
smallSample <- replicate(1000, mpmsim::simulate_mpm(mat_U = matU, mat_F = matF,sample_size = 10,split = FALSE), simplify = FALSE)
largeSample <- replicate(1000, mpmsim::simulate_mpm(mat_U = matU, mat_F = matF,sample_size = 50,split = FALSE), simplify = FALSE)
```


```{r}
lambdaValues_large <- sapply(largeSample, popdemo::eigs, what = "lambda")
lambdaValues_small <- sapply(smallSample, popdemo::eigs, what = "lambda")
hist(lambdaValues_small)
hist(lambdaValues_large)
sd(lambdaValues_large)
sd(lambdaValues_small)

```

